import{d as h,o as t,h as r,n as B,u as i,s as D,r as E,Q as S,x as A,a as s,w as $,F as g,B as N,b as R,k as u,C as V,Z as F}from"./app-CQMZW0J2.js";import{_ as L}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-BkORzJDr.js";import{_ as z}from"./TableSection.vue_vue_type_script_setup_true_lang-DvgDa40M.js";import{_ as d}from"./index-BV5hWh6R.js";import{f as m}from"./fenlab.api-BTqX_Gxk.js";import{t as v}from"./plyr-BxAAciHZ.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CKsY88wo.js";import"./PictureIcon-DHM7ArmB.js";import"./index-QVaIOHb-.js";import"./index-Bf59r0Dh.js";import"./index-Bb4qSo10.js";import"./index-BSMK1Ama.js";import"./Cross2Icon-D777vYBm.js";import"./DataTable.vue_vue_type_script_setup_true_lang-BCyX6HCq.js";import"./ArrowIcon.vue_vue_type_script_setup_true_lang-CSQ7dY8j.js";import"./Input.vue_vue_type_script_setup_true_lang-D7GXFUIS.js";import"./TableRow.vue_vue_type_script_setup_true_lang-B5tlF6ww.js";import"./index-DLyRJMPa.js";import"./recordTypes-32YOpbUo.js";const Q=h({__name:"Skeleton",props:{class:{}},setup(_){const n=_;return(e,C)=>(t(),r("div",{class:B(i(D)("animate-pulse rounded-md bg-primary/10",n.class))},null,2))}}),T={class:"relative"},U={key:"analysis",class:"w-[280px]"},Z={key:"published",class:"w-[280px]"},q={key:"approved",class:"w-[280px]"},H={key:"signed",class:"w-[280px]"},J=h({__name:"KpisSection",setup(_){var y,b,k;const n=E(!0),e=E({analysis:{},published:{},approved:{},signed:{}}),f=(k=(b=(y=S().props)==null?void 0:y.auth)==null?void 0:b.salesforceUser)==null?void 0:k.email;async function I(){var l,p,o;try{const{data:c}=await m.post("",{method:"get",path:"projects/kpi"});e.value.analysis=c}catch(c){v({variant:"danger",title:((o=(p=(l=c.response)==null?void 0:l.data)==null?void 0:p.message)==null?void 0:o.join(`
`))||"Error al obtener KPI de análisis"})}}async function M(){var l,p,o,c,x,w,j,K,O;try{const a=await m.get("/salesforce/published-kpi",{params:{email:f}});e.value.published=a.data}catch(a){v({variant:"danger",title:((o=(p=(l=a.response)==null?void 0:l.data)==null?void 0:p.message)==null?void 0:o.join(`
`))||"Error al obtener KPI de publicaciones"})}try{const a=await m.get("/salesforce/approved-kpi",{params:{email:f}});e.value.approved=a.data}catch(a){v({variant:"danger",title:((w=(x=(c=a.response)==null?void 0:c.data)==null?void 0:x.message)==null?void 0:w.join(`
`))||"Error al obtener KPI de aprobaciones"})}try{const a=await m.get("/salesforce/signed-kpi",{params:{email:f}});e.value.signed=a.data}catch(a){v({variant:"danger",title:((O=(K=(j=a.response)==null?void 0:j.data)==null?void 0:K.message)==null?void 0:O.join(`
`))||"Error al obtener KPI de firmas"})}}async function P(){n.value=!0;try{await Promise.all([I(),M()])}finally{n.value=!1}}return A(()=>{P()}),(l,p)=>(t(),r("div",T,[s(V,{name:"fade",mode:"out-in",tag:"div",class:"flex flex-wrap gap-10"},{default:$(()=>[n.value?(t(),r(g,{key:0},N(4,o=>R("div",{key:`skeleton-${o}`,class:"w-[280px]"},[s(i(Q),{class:"h-[120px] bg-olive"})])),64)):(t(),r(g,{key:1},[Object.keys(e.value.analysis).length?(t(),r("div",U,[s(i(d),{variant:"default","is-positive":!0,title:"Análisis hechos mes actual vs mes anterior.",value:e.value.analysis.currentMonth,percentage:e.value.analysis.percentage},null,8,["value","percentage"])])):u("",!0),Object.keys(e.value.published).length?(t(),r("div",Z,[s(i(d),{variant:"primary","is-positive":!0,title:"Operaciones publicadas mes actual vs mes anterior.",value:e.value.published.currentMonth,percentage:e.value.published.variation},null,8,["value","percentage"])])):u("",!0),Object.keys(e.value.approved).length?(t(),r("div",q,[s(i(d),{variant:"primary","is-positive":!0,title:"Operaciones aprobadas mes actual vs mes anterior.",value:e.value.approved.currentMonth,percentage:e.value.approved.variation},null,8,["value","percentage"])])):u("",!0),Object.keys(e.value.signed).length?(t(),r("div",H,[s(i(d),{variant:"primary","is-positive":!0,title:"Operaciones firmadas mes actual vs mes anterior.",value:e.value.signed.currentMonth,percentage:e.value.signed.variation},null,8,["value","percentage"])])):u("",!0)],64))]),_:1})]))}}),W=G(J,[["__scopeId","data-v-0f58b950"]]),he=h({__name:"Dashboard",props:{sections:{},kpiData:{}},setup(_){return(n,e)=>(t(),r(g,null,[s(i(F),{title:"Dashboard"}),s(L,null,{default:$(()=>[s(W),s(i(z),{sections:n.sections},null,8,["sections"])]),_:1})],64))}});export{he as default};
