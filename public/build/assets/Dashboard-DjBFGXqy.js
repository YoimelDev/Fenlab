import{d as h,o as t,h as r,n as B,u as i,z as C,r as E,Q as D,q as S,a as s,w as $,F as g,A as N,b as R,k as u,B as V,Z as z}from"./app-DU1v3jkr.js";import{_ as F}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-CUmHzLNt.js";import{_ as L}from"./TableSection.vue_vue_type_script_setup_true_lang-CU8SA_tg.js";import{_ as d}from"./index-B6nrB8pM.js";import{f as m}from"./fenlab.api-Cf4gwDdb.js";import{t as v}from"./plyr-CplpJfE2.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Cm8GW7Ju.js";import"./PictureIcon-DPv4h-T6.js";import"./index-CSagTUk7.js";import"./index-VNtmGLgX.js";import"./index-Bb4qSo10.js";import"./index-kmOVfz8t.js";import"./Cross2Icon-WKpfJnr9.js";import"./DataTable.vue_vue_type_script_setup_true_lang-B_jWZGLo.js";import"./ArrowIcon.vue_vue_type_script_setup_true_lang-3x-GNO8s.js";import"./Input.vue_vue_type_script_setup_true_lang-NNBmrnwZ.js";import"./TableRow.vue_vue_type_script_setup_true_lang-DqcTJVCr.js";import"./index-NJhH1dxI.js";import"./recordTypes-32YOpbUo.js";const G=h({__name:"Skeleton",props:{class:{}},setup(_){const n=_;return(e,I)=>(t(),r("div",{class:B(i(C)("animate-pulse rounded-md bg-primary/10",n.class))},null,2))}}),Q={class:"relative"},T={key:"analysis",class:"w-[280px]"},U={key:"published",class:"w-[280px]"},Z={key:"approved",class:"w-[280px]"},H={key:"signed",class:"w-[280px]"},J=h({__name:"KpisSection",setup(_){var y,b,k;const n=E(!0),e=E({analysis:{},published:{},approved:{},signed:{}}),f=(k=(b=(y=D().props)==null?void 0:y.auth)==null?void 0:b.salesforceUser)==null?void 0:k.email;async function M(){var l,p,o;try{const{data:c}=await m.post("",{method:"get",path:"projects/kpi"});e.value.analysis=c}catch(c){v({variant:"danger",title:((o=(p=(l=c.response)==null?void 0:l.data)==null?void 0:p.message)==null?void 0:o.join(`
`))||"Error al obtener KPI de análisis"})}}async function P(){var l,p,o,c,w,x,j,K,O;try{const a=await m.get("/salesforce/published-kpi",{params:{email:f}});e.value.published=a.data}catch(a){v({variant:"danger",title:((o=(p=(l=a.response)==null?void 0:l.data)==null?void 0:p.message)==null?void 0:o.join(`
`))||"Error al obtener KPI de publicaciones"})}try{const a=await m.get("/salesforce/approved-kpi",{params:{email:f}});e.value.approved=a.data}catch(a){v({variant:"danger",title:((x=(w=(c=a.response)==null?void 0:c.data)==null?void 0:w.message)==null?void 0:x.join(`
`))||"Error al obtener KPI de aprobaciones"})}try{const a=await m.get("/salesforce/signed-kpi",{params:{email:f}});e.value.signed=a.data}catch(a){v({variant:"danger",title:((O=(K=(j=a.response)==null?void 0:j.data)==null?void 0:K.message)==null?void 0:O.join(`
`))||"Error al obtener KPI de firmas"})}}async function A(){n.value=!0;try{await Promise.all([M(),P()])}finally{n.value=!1}}return S(()=>{A()}),(l,p)=>(t(),r("div",Q,[s(V,{name:"fade",mode:"out-in",tag:"div",class:"flex flex-wrap gap-10"},{default:$(()=>[n.value?(t(),r(g,{key:0},N(4,o=>R("div",{key:`skeleton-${o}`,class:"w-[280px]"},[s(i(G),{class:"h-[120px] bg-olive"})])),64)):(t(),r(g,{key:1},[Object.keys(e.value.analysis).length?(t(),r("div",T,[s(i(d),{variant:"default","is-positive":!0,title:"Análisis hechos mes actual vs mes anterior.",value:e.value.analysis.currentMonth,percentage:e.value.analysis.percentage},null,8,["value","percentage"])])):u("",!0),Object.keys(e.value.published).length?(t(),r("div",U,[s(i(d),{variant:"primary","is-positive":!0,title:"Operaciones publicadas mes actual vs mes anterior.",value:e.value.published.currentMonth,percentage:e.value.published.variation},null,8,["value","percentage"])])):u("",!0),Object.keys(e.value.approved).length?(t(),r("div",Z,[s(i(d),{variant:"primary","is-positive":!0,title:"Operaciones aprobadas mes actual vs mes anterior.",value:e.value.approved.currentMonth,percentage:e.value.approved.variation},null,8,["value","percentage"])])):u("",!0),Object.keys(e.value.signed).length?(t(),r("div",H,[s(i(d),{variant:"primary","is-positive":!0,title:"Operaciones firmadas mes actual vs mes anterior.",value:e.value.signed.currentMonth,percentage:e.value.signed.variation},null,8,["value","percentage"])])):u("",!0)],64))]),_:1})]))}}),W=q(J,[["__scopeId","data-v-0f58b950"]]),he=h({__name:"Dashboard",props:{sections:{},kpiData:{}},setup(_){return(n,e)=>(t(),r(g,null,[s(i(z),{title:"Dashboard"}),s(F,null,{default:$(()=>[s(W),s(i(L),{sections:n.sections},null,8,["sections"])]),_:1})],64))}});export{he as default};
