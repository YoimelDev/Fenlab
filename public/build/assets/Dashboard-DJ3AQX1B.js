import{d as h,o as t,g as r,n as C,u as i,r as E,Q as D,s as S,a as s,w as $,F as g,z as B,b as N,j as u,A as R,Z as V}from"./app-DXd3upE_.js";import{_ as z}from"./AuthenticatedLayout.vue_vue_type_script_setup_true_lang-CNFZdwDo.js";import{_ as F}from"./TableSection.vue_vue_type_script_setup_true_lang-CdgajF7h.js";import{_ as d}from"./index-y-08atvH.js";import{f as m}from"./fenlab.api-njFr3qRX.js";import{t as v}from"./plyr-PSGV0kqJ.js";import{c as L}from"./utils-CQ8dxi7B.js";import{_ as G}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-tIBGlZe9.js";import"./PictureIcon-B1vPA-qp.js";import"./index-B3Rang4Z.js";import"./index-Bb4qSo10.js";import"./index-DZbCAswk.js";import"./Cross2Icon-DIrK5Gf2.js";import"./DataTable.vue_vue_type_script_setup_true_lang-CRUuUmBH.js";import"./ArrowIcon.vue_vue_type_script_setup_true_lang-CscXK0N0.js";import"./Input.vue_vue_type_script_setup_true_lang-CYwbGssj.js";import"./TableRow.vue_vue_type_script_setup_true_lang-DN_ACuhV.js";import"./index-BYjG_4g4.js";import"./recordTypes-32YOpbUo.js";const Q=h({__name:"Skeleton",props:{class:{}},setup(_){const n=_;return(e,I)=>(t(),r("div",{class:C(i(L)("animate-pulse rounded-md bg-primary/10",n.class))},null,2))}}),T={class:"relative"},U={key:"analysis",class:"w-[280px]"},Z={key:"published",class:"w-[280px]"},q={key:"approved",class:"w-[280px]"},H={key:"signed",class:"w-[280px]"},J=h({__name:"KpisSection",setup(_){var y,b,k;const n=E(!0),e=E({analysis:{},published:{},approved:{},signed:{}}),f=(k=(b=(y=D().props)==null?void 0:y.auth)==null?void 0:b.salesforceUser)==null?void 0:k.email;async function M(){var l,p,o;try{const{data:c}=await m.post("",{method:"get",path:"projects/kpi"});e.value.analysis=c}catch(c){v({variant:"danger",title:((o=(p=(l=c.response)==null?void 0:l.data)==null?void 0:p.message)==null?void 0:o.join(`
`))||"Error al obtener KPI de análisis"})}}async function P(){var l,p,o,c,w,x,j,K,O;try{const a=await m.get("/salesforce/published-kpi",{params:{email:f}});e.value.published=a.data}catch(a){v({variant:"danger",title:((o=(p=(l=a.response)==null?void 0:l.data)==null?void 0:p.message)==null?void 0:o.join(`
`))||"Error al obtener KPI de publicaciones"})}try{const a=await m.get("/salesforce/approved-kpi",{params:{email:f}});e.value.approved=a.data}catch(a){v({variant:"danger",title:((x=(w=(c=a.response)==null?void 0:c.data)==null?void 0:w.message)==null?void 0:x.join(`
`))||"Error al obtener KPI de aprobaciones"})}try{const a=await m.get("/salesforce/signed-kpi",{params:{email:f}});e.value.signed=a.data}catch(a){v({variant:"danger",title:((O=(K=(j=a.response)==null?void 0:j.data)==null?void 0:K.message)==null?void 0:O.join(`
`))||"Error al obtener KPI de firmas"})}}async function A(){n.value=!0;try{await Promise.all([M(),P()])}finally{n.value=!1}}return S(()=>{A()}),(l,p)=>(t(),r("div",T,[s(R,{name:"fade",mode:"out-in",tag:"div",class:"flex flex-wrap gap-10"},{default:$(()=>[n.value?(t(),r(g,{key:0},B(4,o=>N("div",{key:`skeleton-${o}`,class:"w-[280px]"},[s(i(Q),{class:"h-[120px] bg-olive"})])),64)):(t(),r(g,{key:1},[Object.keys(e.value.analysis).length?(t(),r("div",U,[s(i(d),{variant:"default","is-positive":!0,title:"Análisis hechos mes actual vs mes anterior.",value:e.value.analysis.currentMonth,percentage:e.value.analysis.percentage},null,8,["value","percentage"])])):u("",!0),Object.keys(e.value.published).length?(t(),r("div",Z,[s(i(d),{variant:"primary","is-positive":!0,title:"Operaciones publicadas mes actual vs mes anterior.",value:e.value.published.currentMonth,percentage:e.value.published.variation},null,8,["value","percentage"])])):u("",!0),Object.keys(e.value.approved).length?(t(),r("div",q,[s(i(d),{variant:"primary","is-positive":!0,title:"Operaciones aprobadas mes actual vs mes anterior.",value:e.value.approved.currentMonth,percentage:e.value.approved.variation},null,8,["value","percentage"])])):u("",!0),Object.keys(e.value.signed).length?(t(),r("div",H,[s(i(d),{variant:"primary","is-positive":!0,title:"Operaciones firmadas mes actual vs mes anterior.",value:e.value.signed.currentMonth,percentage:e.value.signed.variation},null,8,["value","percentage"])])):u("",!0)],64))]),_:1})]))}}),W=G(J,[["__scopeId","data-v-0f58b950"]]),he=h({__name:"Dashboard",props:{sections:{},kpiData:{}},setup(_){return(n,e)=>(t(),r(g,null,[s(i(V),{title:"Dashboard"}),s(z,null,{default:$(()=>[s(W),s(i(F),{sections:n.sections},null,8,["sections"])]),_:1})],64))}});export{he as default};
